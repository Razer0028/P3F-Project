<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>edge-stack Docs</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body data-lang="ja" class="docs-page">
    <div class="backdrop"></div>
    <header class="docs-hero">
      <div class="docs-hero-inner">
        <p class="kicker">Documentation</p>
        <h1>edge-stack 運用・構成ガイド</h1>
        <p class="lede">
          卒業制作の要件と、現在の IaC 構成を誰でも再現できる形に落とし込むための
          詳細ガイドです。安全設計・運用・フェイルオーバー・バックアップまでを
          一覧できるようにまとめています。
        </p>
        <div class="docs-actions">
          <a class="doc-btn" href="index.html">ポータルへ戻る</a>
          <a class="doc-btn ghost" href="#quickstart">クイックスタートへ</a>
        </div>
        <div class="doc-note">
          このページは日本語のみです。英語版が必要ならお知らせください。
        </div>
      </div>
    </header>

    <main class="docs-layout">
      <aside class="docs-nav">
        <h2>目次</h2>
        <nav>
          <a href="#overview">1. 概要</a>
          <a href="#status">2. 進捗と対応状況</a>
          <a href="#goals">3. 目的と成果</a>
          <a href="#architecture">4. 構成と役割</a>
          <a href="#flows">5. 通信フロー</a>
          <a href="#security">6. セキュリティ層</a>
          <a href="#failover">7. フェイルオーバー</a>
          <a href="#iac">8. IaC 構成</a>
          <a href="#modes">9. 構成モード</a>
          <a href="#quickstart">10. クイックスタート</a>
          <a href="#portal">11. ポータル利用</a>
          <a href="#portctl">12. Portctl</a>
          <a href="#cloudflare">13. Cloudflare 設定</a>
          <a href="#failover-check">14. フェイルオーバー検証</a>
          <a href="#secrets">15. 秘密情報管理</a>
          <a href="#ops">16. 運用・検証</a>
          <a href="#faq">17. FAQ / トラブルシュート</a>
          <a href="#limits">18. 制約と注意点</a>
        </nav>
      </aside>

      <section class="docs-content">
        <section id="overview" class="doc-section">
          <h2>1. 概要</h2>
          <p>
            edge-stack は、自宅オンプレで稼働するゲームサーバーと Web サイトを
            外部から安全に公開し、障害時には EC2 に経路を切り替える構成を IaC で
            再現可能にしたプロジェクトです。
          </p>
          <ul>
            <li>オンプレの実IPを秘匿</li>
            <li>VPS/EC2 に防御層を持たせる</li>
            <li>Failover を自動化</li>
            <li>Docker でサービスを分離</li>
            <li>IaC で構成を公開・再現可能にする</li>
          </ul>
        </section>

        <section id="status" class="doc-section">
          <h2>2. 進捗と対応状況</h2>
          <div class="doc-grid">
            <div class="doc-card">
              <h3>進捗率</h3>
              <p><strong>100%</strong>（公開可能な IaC としての完成度）</p>
              <p>
                構築・検証・公開向けドキュメントまで整備済みです。
                運用後の拡張は任意です。
              </p>
            </div>
            <div class="doc-card">
              <h3>完了済み</h3>
              <ul>
                <li>Ansible 主要ロール（WG/FRR/Suricata/Cloudflared/Portctl/Backups/Containers）</li>
                <li>Terraform（VPC/EIP/SG/EC2）と自動/カスタム VPC モード</li>
                <li>ポータルのガイド/カスタム両モードと生成機能</li>
              </ul>
            </div>
            <div class="doc-card">
              <h3>今後の拡張（任意）</h3>
              <ul>
                <li>Cloudflare WAF/Access の追加チューニング</li>
                <li>Suricata ルールの拡充と閾値調整</li>
                <li>ゲームサーバーの追加テンプレート</li>
              </ul>
            </div>
          </div>
          <table class="doc-table">
            <thead>
              <tr>
                <th>領域</th>
                <th>状態</th>
                <th>補足</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>IaC (Ansible)</td>
                <td>完了</td>
                <td>主要ロールは実装済み。nginx は未実装。</td>
              </tr>
              <tr>
                <td>IaC (Terraform)</td>
                <td>完了</td>
                <td>VPC/IGW/Subnet/SG/EIP/EC2 を自動構築。</td>
              </tr>
              <tr>
                <td>ポータル</td>
                <td>完了</td>
                <td>ガイド/カスタム、依存関係判定、出力生成。</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td>完了</td>
                <td>Zone/DNS/Tunnel はTerraform、NS切替は手順に含める。</td>
              </tr>
              <tr>
                <td>運用/検証</td>
                <td>完了</td>
                <td>validate とフェイルオーバー手順を用意。</td>
              </tr>
            </tbody>
          </table>
        </section>

        <section id="goals" class="doc-section">
          <h2>3. 目的と成果</h2>
          <div class="doc-grid">
            <div class="doc-card">
              <h3>低コストで安全に公開</h3>
              <p>
                攻撃面を VPS/EC2 に集約し、オンプレは直接露出しない構成にすることで
                リスクを最小化します。
              </p>
            </div>
            <div class="doc-card">
              <h3>フェイルオーバー対応</h3>
              <p>
                VPS 障害時に EC2 経路へ切替し、サービス停止を最小化します。
              </p>
            </div>
            <div class="doc-card">
              <h3>運用自動化</h3>
              <p>
                Python/PHP の管理機能と IaC を組み合わせ、構築・更新・検証の手順を
                再現可能にします。
              </p>
            </div>
          </div>
        </section>

        <section id="architecture" class="doc-section">
          <h2>4. 構成と役割</h2>
          <table class="doc-table">
            <thead>
              <tr>
                <th>ノード</th>
                <th>役割</th>
                <th>主な要素</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>オンプレ (Debian 12)</td>
                <td>アプリ本体</td>
                <td>ゲームサーバー / Web / 管理ポータル / Docker</td>
              </tr>
              <tr>
                <td>VPS</td>
                <td>公開エッジ</td>
                <td>WireGuard / Portctl / Suricata / FRR-BFD / Cloudflared</td>
              </tr>
              <tr>
                <td>EC2</td>
                <td>代替経路</td>
                <td>WireGuard / Suricata / Cloudflared (必要時)</td>
              </tr>
              <tr>
                <td>NAS</td>
                <td>バックアップ</td>
                <td>Synology DS223j</td>
              </tr>
            </tbody>
          </table>
        </section>

        <section id="flows" class="doc-section">
          <h2>5. 通信フロー</h2>
          <div class="doc-flow">
            <h3>Web (HTTP/HTTPS)</h3>
            <p>
              Cloudflare (DNS/WAF) → cloudflared → オンプレ Web
            </p>
          </div>
          <div class="doc-flow">
            <h3>ゲーム (UDP/TCP)</h3>
            <p>
              外部 → VPS ポートフォワード → WireGuard → オンプレ
              （障害時は EC2 経由へ切替）
            </p>
          </div>
        </section>

        <section id="security" class="doc-section">
          <h2>6. セキュリティ層</h2>
          <ul>
            <li>Cloudflare: WAF/Access/Rate limit</li>
            <li>WireGuard: トンネル化と IP 秘匿</li>
            <li>Suricata: IDS/IPS で検知/遮断</li>
            <li>UFW: 入口ポート制御</li>
          </ul>
          <div class="doc-note">
            Web は Cloudflare 経由、ゲームポートは VPS/EC2 経由でオンプレを保護します。
          </div>
        </section>

        <section id="failover" class="doc-section">
          <h2>7. フェイルオーバー</h2>
          <ul>
            <li>FRR/BFD が VPS の死活を監視</li>
            <li>failover_core が wg0/wg1 と DNS を切替</li>
            <li>障害時は EC2 経由へ自動移行</li>
          </ul>
          <div class="doc-warning">
            同時に wg0/wg1 を有効化しないでください。
          </div>
        </section>

        <section id="iac" class="doc-section">
          <h2>8. IaC 構成</h2>
          <h3>Ansible (自動化対象)</h3>
          <div class="doc-grid">
            <div class="doc-card">
              <h4>基盤</h4>
              <ul>
                <li>base: 共通パッケージ/基本設定</li>
                <li>docker: Docker + Compose</li>
                <li>containers: ゲーム/Web/監視コンテナ展開</li>
              </ul>
            </div>
            <div class="doc-card">
              <h4>ネットワーク</h4>
              <ul>
                <li>wireguard: wg0/wg1</li>
                <li>frr: BFD/ルーティング</li>
                <li>failover_core: 切替スクリプト</li>
                <li>portctl: VPS ポートフォワード UI</li>
              </ul>
            </div>
            <div class="doc-card">
              <h4>セキュリティ/運用</h4>
              <ul>
                <li>suricata: IDS/IPS</li>
                <li>cloudflared: Web トンネル</li>
                <li>backups: NAS へのバックアップ</li>
              </ul>
            </div>
          </div>
          <div class="doc-note">
            nginx ロールは未実装のため未使用です。
          </div>
          <h3>Terraform (AWS 自動構築)</h3>
          <ul>
            <li>VPC/IGW/Public Subnet/Route Table を自動作成</li>
            <li>Security Group と EIP を作成、EC2 に関連付け</li>
            <li>vpc_mode=auto/custom 対応、既定の許可ポートは 22/TCP と 51820/UDP</li>
            <li>KeyPair は既存利用/新規作成を選択可能</li>
            <li>AMI はユーザー指定（t4g を使う場合は ARM64 を指定）</li>
            <li>EC2 インスタンスタイプ既定: <code>t4g.medium</code></li>
          </ul>
          <h3>Terraform 用 IAM ポリシー</h3>
          <p>
            最小権限の例です。IAM ユーザー/ロールに付与して Terraform を実行します。
          </p>
          <pre><code>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "EC2Read",
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeAvailabilityZones",
        "ec2:DescribeAddresses",
        "ec2:DescribeImages",
        "ec2:DescribeInstances",
        "ec2:DescribeInstanceTypes",
        "ec2:DescribeInternetGateways",
        "ec2:DescribeKeyPairs",
        "ec2:DescribeNetworkInterfaces",
        "ec2:DescribeRouteTables",
        "ec2:DescribeSecurityGroups",
        "ec2:DescribeSubnets",
        "ec2:DescribeTags",
        "ec2:DescribeVpcAttribute",
        "ec2:DescribeVpcs"
      ],
      "Resource": "*"
    },
    {
      "Sid": "EC2Write",
      "Effect": "Allow",
      "Action": [
        "ec2:AllocateAddress",
        "ec2:AssociateAddress",
        "ec2:AttachInternetGateway",
        "ec2:AuthorizeSecurityGroupIngress",
        "ec2:AuthorizeSecurityGroupEgress",
        "ec2:CreateInternetGateway",
        "ec2:CreateRoute",
        "ec2:CreateRouteTable",
        "ec2:CreateSecurityGroup",
        "ec2:CreateSubnet",
        "ec2:CreateTags",
        "ec2:CreateVpc",
        "ec2:DeleteInternetGateway",
        "ec2:DeleteRoute",
        "ec2:DeleteRouteTable",
        "ec2:DeleteSecurityGroup",
        "ec2:DeleteSubnet",
        "ec2:DeleteTags",
        "ec2:DeleteVpc",
        "ec2:DetachInternetGateway",
        "ec2:DisassociateAddress",
        "ec2:DisassociateRouteTable",
        "ec2:ImportKeyPair",
        "ec2:DeleteKeyPair",
        "ec2:ModifySubnetAttribute",
        "ec2:ModifyVpcAttribute",
        "ec2:ReleaseAddress",
        "ec2:ReplaceRoute",
        "ec2:ReplaceRouteTableAssociation",
        "ec2:RevokeSecurityGroupIngress",
        "ec2:RevokeSecurityGroupEgress",
        "ec2:RunInstances",
        "ec2:TerminateInstances"
      ],
      "Resource": "*"
    }
  ]
}</code></pre>
          <div class="doc-note">
            フル版は <code>docs/iam_terraform_policy.json</code> にあります。
          </div>
          <h3>ポータル / 付帯スクリプト</h3>
          <ul>
            <li>ガイド付き/カスタムの 2 モード</li>
            <li>inventory, group_vars, tfvars, checklist, next steps を生成</li>
            <li>依存関係の自動チェックと警告表示</li>
            <li><code>scripts/bootstrap.sh</code> と <code>scripts/validate.sh</code> を同梱</li>
          </ul>
        </section>

        <section id="modes" class="doc-section">
          <h2>9. 構成モード</h2>
          <ul>
            <li>1台: オンプレのみ</li>
            <li>2台: オンプレ + VPS</li>
            <li>3台: オンプレ + VPS + EC2</li>
          </ul>
          <p>
            ポータルのテンプレートで推奨チェックが入ります。
            必要に応じてカスタムで機能を選択できます。
          </p>
        </section>

        <section id="quickstart" class="doc-section">
          <h2>10. クイックスタート</h2>
          <ol>
            <li><code>./scripts/bootstrap.sh</code> を実行</li>
            <li>Vault パスワードを作成</li>
            <li>Vault ファイルに秘密情報を記入</li>
            <li>Ansible を適用</li>
            <li><code>make validate</code> で検証</li>
          </ol>
          <pre><code>./scripts/bootstrap.sh
ansible-vault edit ~/.config/edge-stack/ansible/host_vars/vps-1.yml
ANSIBLE_CONFIG=./ansible.cfg ansible-playbook -i ~/.config/edge-stack/ansible/hosts.ini ansible/site.yml -l vps
make validate</code></pre>
        </section>

        <section id="portal" class="doc-section">
          <h2>11. ポータル利用</h2>
          <ul>
            <li>ガイド付き: 手順を順番に実行</li>
            <li>カスタム: 必要な操作だけ選択</li>
          </ul>
          <div class="doc-note">
            ポータルはローカル/LAN 専用で使ってください。
          </div>
        </section>

        <section id="portctl" class="doc-section">
          <h2>12. Portctl</h2>
          <ul>
            <li>WG: <code>http://&lt;wg_vps_ip&gt;:9000/</code></li>
            <li>Local: <code>http://127.0.0.1:9000/</code></li>
          </ul>
          <p>
            外向きインターフェースは自動検出ですが、
            <code>/etc/portctl/config.json</code> の
            <code>public_interface</code> で固定できます。
          </p>
        </section>

        <section id="cloudflare" class="doc-section">
          <h2>13. Cloudflare 設定</h2>
          <p>
            Cloudflare の Zone/DNS/Tunnel は Terraform で自動化できます。
            ただし <strong>ネームサーバー変更だけは手動</strong> です。
            VPS と EC2 は <strong>別トンネル</strong> で運用する前提です。
          </p>
          <ul>
            <li>zone_name は <strong>購入したドメインのルート</strong>（例: YOUR_DOMAIN）</li>
            <li>Web: VPS = <code>www.YOUR_DOMAIN</code>, EC2 = <code>sub.YOUR_DOMAIN</code></li>
            <li>ゲーム: <code>game.YOUR_DOMAIN</code>（Aレコード, DNS only / Proxy 無効）</li>
          </ul>
          <ol>
            <li>Cloudflare Zone を作成（Terraform）</li>
            <li>レジストラ側でネームサーバーを Cloudflare に変更</li>
            <li>反映確認後に DNS が有効化される</li>
            <li>Terraform 出力を Vault に転記</li>
          </ol>
          <div class="doc-grid">
            <div class="doc-card">
              <h3>API トークン (DNS)</h3>
              <ul>
                <li>権限: Zone DNS Edit</li>
                <li>対象ゾーン: 使用するドメインのみ</li>
                <li>failover_core が DNS 切替に使用</li>
              </ul>
            </div>
            <div class="doc-card">
              <h3>トンネル (VPS/EC2)</h3>
              <ul>
                <li>VPS 用と EC2 用で別トンネルを作成</li>
                <li>各トンネルの credentials を保存</li>
                <li>DNS レコードを作成して切替に備える</li>
              </ul>
            </div>
            <div class="doc-card">
              <h3>保存場所</h3>
              <ul>
                <li><code>/etc/cloudflared/config.yml</code></li>
                <li><code>/etc/cloudflared/*.json</code> (credentials)</li>
                <li>秘密情報は Vault へ</li>
              </ul>
            </div>
          </div>
          <p>手順例（VPS/EC2 共通）</p>
          <pre><code>cloudflared tunnel login
cloudflared tunnel create &lt;vps_tunnel_name&gt;
cloudflared tunnel route dns &lt;vps_tunnel_name&gt; www.YOUR_DOMAIN
cloudflared tunnel create &lt;ec2_tunnel_name&gt;
cloudflared tunnel route dns &lt;ec2_tunnel_name&gt; sub.YOUR_DOMAIN</code></pre>
          <p>Terraform 実行例（Cloudflare 側）</p>
          <pre><code>export CLOUDFLARE_API_TOKEN="YOUR_TOKEN"
cd terraform-cloudflare
terraform init
terraform apply -auto-approve -input=false</code></pre>
          <div class="doc-note">
            API トークンは環境変数で渡し、tfvars に保存しないでください。
          </div>
          <div class="doc-note">
            出力の <code>zone_id</code> / <code>failover_record_id</code> は
            <code>failover_cf_zone_id</code> / <code>failover_cf_record_id</code> として
            Vault に保存します。
          </div>
          <div class="doc-note">
            レコードを削除・再作成（CNAME→Aなど）した場合は
            <code>failover_record_id</code> が変わるため、再取得して Vault を更新してください。
          </div>
          <div class="doc-note">
            ゲーム用ドメインは UDP を使うため Proxy を有効化しないでください。
          </div>
          <p>ネームサーバー反映確認</p>
          <pre><code>dig NS YOUR_DOMAIN +short</code></pre>
          <p>config.yml の例（1台ごとに作成）</p>
          <pre><code>tunnel: &lt;TUNNEL_ID&gt;
credentials-file: /etc/cloudflared/&lt;TUNNEL_ID&gt;.json
ingress:
  - hostname: www.YOUR_DOMAIN
    service: http://localhost:80
  - service: http_status:404</code></pre>
          <div class="doc-note">
            ポータル生成結果の <code>cloudflared_vps_vault_snippet.txt</code> /
            <code>cloudflared_ec2_vault_snippet.txt</code> を
            <code>~/.config/edge-stack/ansible/host_vars/*.yml</code> に貼り付けてください。
          </div>
          <div class="doc-note">
            Web トンネルをオンプレに置く場合は、WG の default route と競合しないよう
            AllowedIPs やポリシールーティングを調整してください。
          </div>
        </section>

        <section id="failover-check" class="doc-section">
          <h2>14. フェイルオーバー検証</h2>
          <p>
            検証は <strong>wg0 → wg1 切替</strong> の一連で実施します。
            作業後は必ず wg0 に戻してください。
          </p>
          <ol>
            <li>稼働確認: <code>systemctl is-active wg-quick@wg0</code></li>
            <li>状態確認: <code>wg show</code>, <code>ip route</code></li>
            <li>VPS 停止を模擬: VPS 側 <code>systemctl stop wg-quick@wg0</code></li>
            <li>オンプレで切替確認: <code>systemctl status failover_core</code></li>
            <li>EC2 へ切替後に疎通確認</li>
            <li>検証完了後は wg0 に戻す</li>
          </ol>
          <div class="doc-note">
            BFD/FRR を使う場合は <code>vtysh -c "show bfd peer"</code> で死活を確認できます。
          </div>
        </section>

        <section id="secrets" class="doc-section">
          <h2>15. 秘密情報管理</h2>
          <h3>必須入力</h3>
          <ul>
            <li>ホスト情報: on-prem/VPS/EC2 の IP・SSH ユーザー・SSH 鍵名（鍵は <code>~/.ssh</code>、通常は <code>/root/.ssh</code>）</li>
            <li>Cloudflare: account ID / zone name（YOUR_DOMAIN）/ API トークン（環境変数）</li>
            <li>Terraform(EC2): aws_region / instance_type / key_name / allowed_ssh_cidrs / instance_name</li>
            <li>AMI: <code>ami_mode=manual</code> なら <code>ami_id</code>、<code>ami_mode=auto</code> なら <code>ami_owners</code> + <code>ami_name_filter</code></li>
            <li>Failover: failover_ec2_ip / failover_vps_ip / failover_dns_record_name</li>
            <li>通知（任意）: Discord webhook（ポータルの <code>discord_webhook</code> に入力）</li>
          </ul>
          <h3>Vault に入れるもの</h3>
          <ul>
            <li>Vault: <code>~/.config/edge-stack/ansible/host_vars/*.yml</code> に保存</li>
            <li>Vault パス: <code>~/.config/edge-stack/vault_pass</code></li>
            <li>WireGuard: 秘密鍵を含む設定一式</li>
            <li>WireGuard helper: <code>./scripts/wireguard_wizard.sh</code></li>
            <li>WireGuard のサンプル IP は <code>10.100.0.0/24</code> を想定しています</li>
            <li>Cloudflared: config + credentials JSON</li>
            <li>Failover: CF token / zone ID / record ID</li>
            <li>Suricata: カスタムルール（使う場合）</li>
            <li>DDoS通知（VPSのみ）: <code>ddos_notify_primary_ip</code> / <code>ddos_notify_signatures</code>（通知先は Discord webhook を共通利用）</li>
            <li>管理者画面は必須: <code>web_portal_admin_user</code> / <code>web_portal_admin_password</code> を設定</li>
            <li>管理者画面の許可CIDRは WG/LAN を指定（空だとアクセス不可）</li>
            <li>LAN CIDR はポータルのステータス確認時に自動検出されます</li>
            <li><code>admin_vault_snippet.txt</code> / Cloudflaredのスニペットを貼り付けると便利</li>
          </ul>
          <h3>公開前チェック</h3>
          <ul>
            <li><code>~/.config/edge-stack/ansible/host_vars/*.yml</code> と <code>~/.config/edge-stack/ansible/hosts.ini</code> を公開しない</li>
            <li><code>~/.config/edge-stack/terraform/terraform.tfvars</code> と <code>~/.config/edge-stack/terraform-cloudflare/terraform.tfvars</code> を公開しない</li>
            <li>例のプレースホルダ（YOUR_*）を実値に置換してから適用</li>
            <li>ポータル出力に実 IP / 秘密が混ざっていないことを確認</li>
          </ul>
        </section>

        <section id="ops" class="doc-section">
          <h2>16. 運用・検証</h2>
          <ul>
            <li><code>make validate</code> で稼働確認</li>
            <li>サービス異常時は <code>systemctl status</code></li>
            <li>DNS/WG/Suricata の状態を定期確認</li>
          </ul>
        </section>

        <section id="faq" class="doc-section">
          <h2>17. FAQ / トラブルシュート</h2>
          <div class="doc-grid">
            <div class="doc-card">
              <h3>WG 有効時にオンプレから直に Cloudflare を使えない？</h3>
              <p>
                AllowedIPs=0.0.0.0/0 の場合、デフォルト経路が WG に吸われます。
                オンプレ直結で使う場合は AllowedIPs を絞るか、ポリシールーティングで
                Cloudflare 宛を除外してください。<br />
                例: PostUp/PostDown で &lt;VPS|EC2のIP&gt;/32 を table 51821 に追加します。
              </p>
            </div>
            <div class="doc-card">
              <h3>DNS が再起動で戻る</h3>
              <p>
                systemd-resolved / resolvconf の挙動を確認し、恒久化設定を行います。
                例: <code>/etc/systemd/resolved.conf</code> の DNS 指定や
                <code>/etc/resolv.conf</code> の管理方式を確認してください。
              </p>
            </div>
            <div class="doc-card">
              <h3>sysctl が戻る</h3>
              <p>
                <code>/etc/sysctl.d/99-forward.conf</code> に
                <code>net.ipv4.ip_forward=1</code> を記載し、
                <code>sysctl --system</code> を実行します。
              </p>
            </div>
            <div class="doc-card">
              <h3>ホストキー競合</h3>
              <p>
                VPS/EC2 を切替えた後に SSH が失敗する場合は
                <code>ssh-keygen -R &lt;IP&gt;</code> で既存キーを削除します。
              </p>
            </div>
            <div class="doc-card">
              <h3>t4g.medium の AMI</h3>
              <p>
                t4g は ARM64 です。Debian 13 など ARM64 の AMI を指定してください。
              </p>
            </div>
            <div class="doc-card">
              <h3>ポート開放の既定</h3>
              <p>
                Terraform の既定は <code>22/TCP</code> と <code>51820/UDP</code>。
                必要なゲームポートは追加で指定してください。
              </p>
            </div>
          </div>
        </section>

        <section id="limits" class="doc-section">
          <h2>18. 制約と注意点</h2>
          <ul>
            <li>Cloudflare の全設定は IaC 化しきれない箇所があります</li>
            <li>VPS 初期構築は手動前提</li>
            <li>AllowedIPs=0.0.0.0/0 の同時接続は競合します</li>
          </ul>
        </section>
      </section>
    </main>
  </body>
</html>
